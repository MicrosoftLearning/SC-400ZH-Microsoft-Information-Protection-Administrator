# 练习 3 - 管理敏感信息类型

Contoso Ltd. 之前遇到过员工在使用票证解决方案处理支持票证时意外发送了客户个人信息的问题。为了在将来指导用户使用，需要使用一种自定义敏感信息类型来识别电子邮件和文档中的员工 ID，这些 ID 由三个大写字符和六个数字组成。为了降低误报率，将使用关键字“员工”和“ID”。在本任务中，你将创建一种新的自定义敏感信息类型、用于基于 EDM 的分类的数据库以及关键字字典。

### 任务 1 - 创建自定义敏感信息类型

在本练习中，你将使用安全与合规中心 PowerShell 模块创建新的自定义敏感信息类型，以识别关键字“员工”和“ID”旁边的员工 ID 的模式。

1. 你仍应使用 **lon-cl1\admin** 帐户登录到客户端 1 VM (LON-CL1)。

2. 在 **Microsoft Edge** 中，导航到 **https://compliance.microsoft.com** 并以 JoniS@WWLxZZZZZZ.onmicrosoft.com（其中 ZZZZZZ 是实验室托管提供程序提供的唯一租户 ID）登录到合规中心。  Joni 的密码应由实验室托管提供程序提供。

3. 从左侧窗格中选择 **“数据分类”**。

4. 如果显示 **“什么是数据分类?”** 消息，请选择 **“关闭”**，并从顶部窗格中选择 **“敏感信息类型”**。 提示：如果合规中心中未显示 **“敏感信息类型”**，则可能是因为你的浏览器中尚未更新 Joni 在之前实验室中对合规性管理员的权限更新。  你可能需要注销并以 JoniS 身份再次登录。

5. 选择 **“+ 创建敏感信息类型”** 打开新建敏感信息类型向导。

6. 在 **“命名敏感信息类型”** 页面上的 **“名称”** 中键入**“Contoso 员工 ID”**。

7. 在 **“说明”** 字段中键入 **“Contoso 员工 ID 的模式。”**，并选择 **“下一步”**。

8. 在 **“为此敏感信息类型定义模式”** 页面上，选择 **“+ 创建模式”**。

9. 在 **“主要元素”** 部分中选择 **“+ 添加主要元素”** 下拉字段，然后选择 **“正则表达式”**。

10. 在 **“ID”** 字段中，键入 *“Contoso ID”*，并在 **“正则表达式”** 字段中输入以下内容： *\s[A-Z]{3}[0-9]{6}\s*，然后选择 **“完成”**。

11. 在 **“支持元素”** 下选择 **“+ 添加支持元素或元素组”** 下拉菜单，然后选择 **“关键字列表”**。

12. 在“ID”字段中，输入 **“员工 ID 关键字”**，并在 **“不区分大小写”** 下面的文本框中输入以下内容： **“员工”**、**“ID”**，然后选择 **“完成”**。

13. 在“新建模式”窗口中，将 **“字符邻近度”** 值减少到 **“100”** 个字符。

14. 选择 **“创建”** 按钮。

15. 在 **“为此敏感信息类型定义模式”** 页面上，选择 **“下一步”**。

16. 在 **“选择要在合规性策略中显示的建议可信度”** 页面上，使用默认值并选择 **“下一步”**。

17. 在 **“查看设置并完成”** 页面上查看设置，然后选择 **“创建”**。成功创建后，选择 **“完成”**。

18. 使浏览器窗口保持打开状态。

你已成功创建新的敏感信息类型，以 3 个大写字母、6 个数字和 100 个字符范围内的关键字‘员工’或‘ID’的形式标识员工 ID。

### 任务 2 - 创建基于 EDM 的分类信息类型

作为额外的搜索模式，你将使用员工数据的数据库架构创建基于 EDM 的分类。数据库源文件将使用员工的以下数据字段进行格式化：Name、Birthdate、StreetAddress 和 EmployeeID。

1. 你仍应使用 **lon-cl1\admin** 帐户登录到客户端 1 VM (LON-CL1)，并且应该以 **Joni Sherman** 身份登录到 Microsoft 365。 

2. 要创建所需的 Azure AD 安全组，请选择右上角的用户图像，然后选择 **“注销”**，以注销 Joni Sherman 帐户。

3. 关闭浏览器窗口，并打开新的浏览器窗口。

4. 在 **Microsoft Edge** 中，导航到 **https://admin.microsoft.com** 。

5. 显示 **“选择帐户”** 页面时，选择 **“使用其他帐户”** 并以 **MOD 管理员**身份 admin@WWLxZZZZZZ.onmicrosoft.com（其中 ZZZZZZ 是实验室托管提供程序提供的唯一租户 ID）登录。  管理员的密码应由实验室托管提供程序提供。

6. 在左侧窗格中，依次选择 **“组”** 和 **“活动组”**。

7. 从顶部窗格中选择 **“添加组”**。

8. 在 **“选择组类型”** 页面上，选择 **“安全性”** 和 **“下一步”**。

9. 在 **“设置基础”** 上，在 **“名称”** 字段中输入以下内容：*EDM_DataUploaders*。  在“说明”字段中，输入 *“将为 EDM 上传数据的人员”*。

10. 选择 **“下一步”**。

11. 在 **“查看并完成添加组”** 页面上，查看设置并选择 **“创建组”**。

12. 当显示 **“已创建新组”** 页面时，选择 **“关闭”**。

13. 从顶部窗格中选择 **“刷新”**，然后从列表中选择新创建的 **“EDM_DataUploaders”** 组以打开右侧窗格。

14. 依次选择 **“成员”** 选项卡和 **“查看全部并管理成员”**。

15. 在 **“管理组成员”** 屏幕中，选择 **“(+)添加成员”**。

16. 选择 **“Joni Sherman”**，选择 **“添加(1)”** 按钮，然后选择后退箭头按钮。

17. 验证 **Joni Sherman** 是否在 **“成员”** 下方列出。

18. 单击 **X** 关闭右侧窗格。

19. 选择带有 MOD 管理员缩写 **“MA”** 的圆圈，然后选择 **“注销”**。

20. 关闭浏览器窗口，然后打开一个新窗口。

21. 导航到 Microsoft 365 合规中心 (https://compliance.microsoft.com)。

22. 显示 **“选择帐户”** 页面时，请选择 **“Joni Sherman”** 并登录。

23. 导航到 **“数据分类”**，然后从顶部窗格中选择 **“精确的数据匹配项”** 选项卡。

24. 选择 **“+ 创建 EDM 架构”** 以创建新的架构定义。

25. 在 **“名称”** 字段中，输入 *“employeedb”*。

26. 在 **“说明”** 字段中，输入 *“员工数据库架构。”*。

27. 选择 **“忽略所有架构字段的分隔符和标点符号”**。

28. 选择 **“选择要忽略的分隔符和标点符号”**，然后依次选择 *“连字符”*、*“句点”*、*“空格”*、*“左括号”* 和 *“右括号”*。

29. 在第一个 **“架构字段名称”** 中输入 *Name*，并标记 **“字段可搜索”** 框。

30. 选择 **“+ 添加架构数据字段”**。

31. 在 **“架构字段名称”** 中的 **“架构字段 2”** 下，输入 *“Birthdate”*。

32. 选择 **“+ 添加架构数据字段”**。

33. 在 **“架构字段名称”** 中的 **“架构字段 3”** 下，输入 *“StreetAddress”*。

34. 选择 **“+ 添加架构数据字段”**。

35. 在 **“架构字段名称”** 中的 **“架构字段 4”** 下，输入 *“EmployeeID”*。

36. 选择 **“字段可搜索”**。 

37. 选择 **“保存”**。

38. 从左侧窗格中选择 **“EDM 敏感信息类型”**。

39. 选择 **“+ 创建 EDM 敏感信息类型”** 以打开 **“EDM 规则包”** 向导。

40. 在 **“定义数据存储架构”** 页面上，选择 **“选择现有 EDM 架构”**。

41. 依次选择 **“employeedb”** 和 **“添加”**。

42. 查看数据存储架构，然后选择 **“下一步”**。

43. 在 **“为此 EDM 敏感信息类型定义模式”** 页面上，选择 **“+ 创建模式”**。

44. 在 **“新建模式”** 右侧窗格的“主要元素”字段中，选择 *“EmployeeID”*。

45. 在 **“选择主要元素的敏感信息类型”** 下，选择 **“选择敏感信息类型”**。 

46. 在 **“搜索栏”** 中，输入 *Contoso* 并按 Enter 键。

47. 依次选择 **“Contoso 员工 ID”** 和 **“完成”**。

48. 选择 **“完成”**。

49. 选择 **“下一步”**。

50. 在 **“选择建议的可信度和字符邻近度”** 中，保留默认值，然后选择 **“下一步”**。

51. 在 **“命名和描述 EDM 敏感信息类型”** 页面中，输入 **“Contoso 员工 EDM”**。

52. 在 **“针对管理员的说明”** 字段中，输入 **“针对员工个人信息的基于 EDM 的敏感信息类型。”**。

53. 选择 **“下一步”**，查看设置，然后选择 **“提交”**。

54. 在 **“已创建你的 EDM 敏感信息类型”** 页面上，选择 **“完成”**。

55. 让 Microsoft 365 合规中心在浏览器中保持打开状态。

你已成功创建基于 EDM 的新分类敏感信息类型，用于从数据库文件源中识别员工数据。

### 任务 3 - 创建基于 EDM 的分类数据源

为了将基于 EDM 的分类与包含敏感数据的数据库关联，接下来需要通过 EDM 上传代理工具对敏感信息类型的实际数据进行哈希处理并上传这些数据。

1. 你仍应使用 **lon-cl1\admin** 帐户登录到客户端 1 VM (LON-CL1)，并且应该以 **Joni Sherman** 身份登录到 Microsoft 365。 

2. 在 **Microsoft Edge** 中，导航到 **https://go.microsoft.com/fwlink/?linkid=2088639** ，以访问 EDM 下载代理。

3. 选择 **“运行”** 以下载并安装该工具。

4. 当安装向导在后台打开时，从任务栏中选择安装程序。

5. 在 **“Microsoft 精确数据匹配上传代理设置”** 中，选择 **“下一步”**。

6. 依次选择 **“我接受许可协议中的条款”** 和 **“下一步”**。

7. 请勿更改默认的 **“目标文件夹”** 路径，并选择 **“下一步”**。

8. 选择 **“安装”** 以执行安装。

9. 当 **“用户帐户控制”** 窗口打开时，选择 **“是”**。

10. 安装完成后，选择 **“完成”**。

11. 选择左下角的 Windows 符号以打开开始菜单，输入 **“记事本”**，然后从开始菜单中选择 **“记事本”**。

12. 在记事本窗口的第一行中输入以下文本：

    `Name,Birthdate,StreetAddress,EmployeeID`

13. 按 Enter 按钮，并将以下文本添加到记事本窗口中的第二行：

    `Joni Sherman,01.06.1980,1 Main Street,CSO123456`

14. 按 Enter 按钮，并将以下文本添加到记事本窗口中的第三行：

    `Lynne Robbins,31.01.1985,2 Secondary Street,CSO654321`

15. 依次选择 **“文件”** 和 **“另存为”**，以保存文件。

16. 从左侧窗格中选择 **“文档”**，并在 **“文件名”** 字段中输入以下内容： *EmployeeData.csv*

17. 选择 **“保存类型:”** 下拉菜单，然后选择 **“所有文件(*.*)”**。

18. 选择 **“编码:”** 下拉菜单，然后依次选择 **“UTF-8”** 和 **“保存”**。

19. 关闭记事本窗口。

20. 在任务栏中使用鼠标右键选择 Windows 符号，然后选择 **PowerShell** 并以管理员身份运行。

21. 当 **“用户帐户控制”** 窗口打开时，选择 **“是”**。

22. 导航到 EDM 上传代理目录：

    `cd "C:\Program Files\Microsoft\EdmUploadAgent"`

23. 通过运行以下 cmdlet，授权帐户将数据库上传到租户：

    `.\EdmUploadAgent.exe /Authorize`

24. 显示 **“选择帐户”** 窗口时，以 JoniS@WWLxZZZZZZ.onmicrosoft.com（其中 ZZZZZZ 是实验室托管提供程序提供的唯一租户 ID）登录。  Joni 的密码应由实验室托管提供程序提供。

25. 通过在 PowerShell 中运行以下脚本，下载基于 EDM 的分类敏感信息类型的数据库架构定义：

    `.\EdmUploadAgent.exe /SaveSchema /DataStoreName employeedb /OutputDir "C:\Users\Admin\Documents\"`

    备注：如果最后一条命令失败，则可能需要更多时间才能应用 **“EDM_DataUploaders”** 组成员身份。可能需要一个小时才能下载架构文件。  如果失败，请继续执行下一个任务，并稍后返回到此步骤。

26. 通过在 PowerShell 中运行以下脚本，对数据库文件进行哈希处理并将其上传到基于 EDM 的分类敏感信息类型：

    `.\EdmUploadAgent.exe /UploadData /DataStoreName employeedb /DataFile "C:\Users\Admin\Documents\EmployeeData.csv" /HashLocation "C:\Users\Admin\Documents\" /Schema "C:\Users\Admin\Documents\employeedb.xml"`

27. 检查上传进度，直到状态更改为已完成，然后运行以下 PowerShell 命令：

    `.\EdmUploadAgent.exe /GetSession /DataStoreName employeedb`

28. 关闭 PowerShell 窗口。

你已成功对基于 EDM 的分类敏感信息类型的数据库文件进行了哈希处理，并上传了该文件。

### 任务 4 - 创建关键字字典

在同事报告病假后，用户发送电子邮件时发生了几次个人信息泄露违规。  发生这种情况时，疾病的原因就会被散布出去。  我们不希望发生这种情况。

1. 你仍应使用 **lon-cl1\admin** 帐户登录到客户端 1 VM (LON-CL1)，并且应该以 **Joni Sherman** 身份登录到 Microsoft 365。 

2. 在 **Microsoft Edge** 中，Office 365 合规中心标签页应该仍处于打开状态。如果是这样，请选择该标签页并继续进行下一步。如果该标签页已关闭，则在新的标签页中，导航到 **https://compliance.microsoft.com** 。

3. 从左侧窗格中选择 **“数据分类”**，并从顶部窗格中选择 **“敏感信息类型”**。

4. 选择 **“+ 创建敏感信息类型”** 打开新建敏感信息类型向导。

5. 在 **“命名敏感信息类型”** 页面上的 **“名称”** 中输入 **“Contoso 疾病列表”**。

6. 在 **“说明”** 字段中输入 *“员工可能患有的疾病清单。”*，然后选择 **“下一步”**。

7. 在 **“为此敏感信息类型定义模式”** 页面上，选择 **“+ 创建模式”**。

8. 选择 **“主要元素”** 下面的下拉字段，然后选择 **“关键字字典”**。

10. 在 **“添加关键字字典”** 页面中，输入名称 **“疾病字典”**。 

11. 在 **“关键字”** 区域中，输入以下关键字，每个关键字单独一行：

    - *流感*
    - *流行性感冒*
    - *感冒*
    - *支气管炎*
    - 耳炎**。

12. 选择 **“完成”**。

13. 在 **“支持元素”** 下，选择 **“+ 添加支持元素或元素组”** 下拉列表，然后选择 **“关键字列表”** 以添加对关键字字典的其他支持。

14. 在 **“添加关键字列表”** 页面的 **“ID”** 字段中输入 **“员工缺勤”**。在 **“不区分大小写”** 框中，输入以下关键字：**“员工”**、**“缺勤”**、**“原因”**，然后选择 **“完成”**。

15. 在 **“新建模式”** 页面上查看配置，然后选择 **“创建”**。

16. 在 **“为此敏感信息类型定义模式”** 中，选择 **“下一步”**。

17. 在 **“选择要在合规性策略中显示的建议可信度”** 中，使用默认值并选择 **“下一步”**。 

18. 在 **“查看设置并完成”** 页面上查看设置，然后选择 **“创建”**。  完成此过程后，选择 **“完成”**。

19. 让 Microsoft 365 合规中心在浏览器中保持打开状态。

你已基于关键字字典成功创建了新的敏感信息类型，并添加了更多关键字以降低误报率。继续进行下一个任务。

### 任务 5 - 使用自定义敏感信息类型

在策略中使用自定义敏感信息类型之前，应始终对其进行测试，否则自定义搜索模式故障可能会导致数据丢失或泄漏。 

1. 你仍应使用 **lon-cl1\admin** 帐户登录到客户端 1 VM (LON-CL1)，并且应该以 **Joni Sherman** 身份登录到 Microsoft 365。 

2. 选择左下角的 Windows 符号以打开开始菜单，输入 **“记事本”**，然后从开始菜单中选择 **“记事本”**。

3. 在记事本窗口中输入以下文本：

    `员工 Joni Sherman EMP123456 因流感/流行性感冒而缺勤。`

4. 依次选择 **“文件”** 和 **“另存为”**。

5. 在左侧窗格中选择“文档”。

6. 在 **“文件名”** 字段中，输入 *SickTestData* 并选择 **“保存”**。

7. 关闭记事本窗口。

8. 在 **Microsoft Edge** 中，Office 365 合规中心标签页应该仍处于打开状态。如果是这样，请选择该标签页并继续进行下一步。如果该标签页已关闭，则在新的标签页中，导航到 **https://compliance.microsoft.com** 。

9. 在左侧导航窗格中，选择 **“数据分类”**，然后选择 **“敏感信息类型”** 选项卡。

10. 在右上方的 **“搜索”** 框中，输入 *Contoso* 并按 Enter。

11. 选择 **“Contoso 员工 ID”** 以打开右侧窗格。

12. 从右侧窗格中选择 **“测试”**。

13. 在 **“上传要测试的文件”** 页面上，选择 **“上传文件”**。

14. 从左侧窗格中选择 **“文档”**，选择 *SickTestData* 文件，然后选择 **“打开”**。

15. 选择 **“测试”** 以开始分析。

16. 在 **“匹配结果”** 页面上，查看找到的匹配项。

17. 选择 **“完成”** 以关闭测试页面。

18. 返回 **“数据分类”** 页面，选择名为 **“Contoso 疾病清单”** 的敏感信息类型。

19. 在右侧窗格中，选择 **“测试”**。

20. 在 **“上传要测试的文件”** 页面上，选择 **“上传文件”**。

21. 从左侧窗格中选择 **“文档”**，选择 *SickTestData* 文件，然后选择 **“打开”**。

22. 选择 **“测试”** 以开始分析。

23. 在 **“匹配结果”** 页面上，查看找到的匹配项。完成查看后，选择 **“完成”**。

你已成功测试了两种自定义敏感信息类型，并验证了搜索模式可以识别所需的模式。你已完成敏感信息类型的创建，可以继续下一个练习。

# 继续进行练习 4 
